<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>FastMoon — Official</title>
<meta name="description" content="FastMoon — professional memecoin landing + airdrop modal (no wallet connect)." />

<style>
  :root{
    --bg1:#050514; --bg2:#0a1236;
    --card: rgba(20,24,60,.86);
    --card2: rgba(0,0,0,.22);
    --line: rgba(255,255,255,.12);
    --text: rgba(255,255,255,.92);
    --muted: rgba(255,255,255,.72);

    --lime:#7CFF5B;
    --cyan:#3CF1FF;
    --pink:#FF4FD8;

    --shadow: 0 30px 120px rgba(0,0,0,.70);
    --r2: 22px;

    --display: "Trebuchet MS","Segoe UI Variable Display","Segoe UI","Avenir Next",
               "SF Pro Display",system-ui,-apple-system,Roboto,Helvetica,Arial;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color: var(--text);
    background:
      radial-gradient(900px 700px at 15% 15%, rgba(255,79,216,.18), transparent 60%),
      radial-gradient(900px 700px at 85% 20%, rgba(60,241,255,.16), transparent 60%),
      radial-gradient(1200px 900px at 50% 120%, rgba(124,255,91,.10), transparent 62%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    min-height:100vh;
    display:flex;
    justify-content:center;
    padding:20px;
    overflow-x:hidden;
  }

  .container{width:100%; max-width:460px}

  /* ===== Header premium ===== */
  .header{text-align:center; margin-bottom:14px;}
  .headerTop{
    display:flex; align-items:center; justify-content:space-between;
    gap:10px; margin-bottom:10px;
  }
  .brandLeft{display:flex; align-items:center; gap:10px; min-width:0;}
  .moon{
    width:34px; height:34px; border-radius:14px;
    background:
      radial-gradient(20px 20px at 60% 40%, rgba(255,255,255,.70), transparent 60%),
      radial-gradient(50px 50px at 30% 70%, rgba(60,241,255,.16), transparent 60%),
      radial-gradient(50px 50px at 60% 30%, rgba(255,79,216,.14), transparent 60%),
      linear-gradient(135deg, rgba(255,79,216,.22), rgba(60,241,255,.18));
    border:1px solid rgba(255,255,255,.16);
    box-shadow: 0 14px 28px rgba(0,0,0,.25);
    position:relative; overflow:hidden;
    flex:0 0 auto;
  }
  .moon:before{
    content:""; position:absolute; width:44px; height:44px; border-radius:50%;
    left:-10px; top:-10px;
    background: radial-gradient(circle at 35% 35%, rgba(255,220,120,.95), rgba(255,220,120,.14) 55%, transparent 70%);
  }

  .brandText{min-width:0; text-align:left}
  .brandTitle{
    margin:0;
    font-family: var(--display);
    font-size:34px;
    letter-spacing:.6px;
    line-height:1.0;
    font-weight:900;
    background: linear-gradient(45deg, rgba(255,255,255,.98), rgba(60,241,255,.92), rgba(255,79,216,.92));
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    text-shadow: 0 10px 38px rgba(60,241,255,.18), 0 10px 44px rgba(255,79,216,.12);
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }
  .brandSub{
    opacity:.78; font-size:12.5px; letter-spacing:.2px; margin-top:2px;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  }

  .miniCtas{display:flex; gap:8px; flex:0 0 auto;}
  .miniBtn{
    border:1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,.08);
    color: rgba(255,255,255,.92);
    padding:10px 10px;
    border-radius:14px;
    cursor:pointer;
    font-weight:900;
    font-size:12px;
    white-space:nowrap;
  }

  /* ===== Cards ===== */
  .card{
    background: var(--card);
    border: 1px solid var(--line);
    border-radius: var(--r2);
    padding: 16px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(14px);
    margin-bottom: 14px;
    position:relative;
    overflow:hidden;
  }
  .card:before{
    content:""; position:absolute; inset:-140px;
    background:
      radial-gradient(circle at 18% 20%, rgba(255,79,216,.18), transparent 60%),
      radial-gradient(circle at 86% 28%, rgba(60,241,255,.14), transparent 60%),
      radial-gradient(circle at 50% 100%, rgba(124,255,91,.10), transparent 70%);
    pointer-events:none;
  }
  .card > *{position:relative}

  h3{margin:0 0 10px; font-size:18px}
  p{margin:0}
  .muted{color:var(--muted)}

  .btn{
    width:100%;
    padding:12px;
    border-radius:14px;
    border:0;
    cursor:pointer;
    font-weight:900;
    color:#081022;
    background: linear-gradient(45deg, var(--lime), var(--cyan), var(--pink));
    transition:.22s;
    margin-top:10px;
    box-shadow: 0 0 0 rgba(0,0,0,0);
  }
  .btn:hover{transform:translateY(-2px); box-shadow:0 0 22px rgba(60,241,255,.22)}
  .btn.secondary{
    background: rgba(255,255,255,.10);
    color: rgba(255,255,255,.92);
    border: 1px solid rgba(255,255,255,.16);
    box-shadow:none;
  }

  .badgeRow{display:flex; flex-wrap:wrap; gap:8px; margin-top:12px;}
  .badge{
    font-size:12px;
    padding:7px 10px;
    border-radius:999px;
    border:1px dashed rgba(255,255,255,.18);
    background: rgba(0,0,0,.14);
    color: rgba(255,255,255,.82);
  }

  .row2{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
  .row2 .btn{margin-top:0; flex:1; min-width:160px}

  /* ===== Tokenomics ===== */
  .token{margin:12px 0 0}
  .tokRow{display:flex; justify-content:space-between; align-items:center; font-size:13px; margin-bottom:6px;}
  .bar{
    height:12px; background:#0d0f18; border-radius:999px; overflow:hidden;
    border:1px solid rgba(255,255,255,.10);
  }
  .fill{
    height:100%; width:0%;
    background: linear-gradient(45deg, var(--lime), var(--cyan), var(--pink));
    animation: grow 1.1s ease forwards;
  }
  @keyframes grow{ from{width:0%} }

  /* ===== CA + Copy ===== */
  .caWrap{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:10px;}
  .caBox{
    flex:1; min-width:240px;
    padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.18);
    font-family: ui-monospace, Menlo, Consolas, monospace;
    font-size:12px;
    overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  }
  .tiny{margin-top:10px; font-size:12px; color: rgba(255,255,255,.70); line-height:1.5;}

  /* ===== Stats pills ===== */
  .stats{
    display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; margin-top:10px;
  }
  @media (max-width:520px){ .stats{grid-template-columns:1fr} }
  .stat{
    padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18);
  }
  .stat b{display:block; font-size:12px; opacity:.85}
  .stat span{display:block; margin-top:6px; font-size:16px; font-weight:900}

  /* ===== Checklist progress ===== */
  .progressWrap{
    margin-top:12px; padding:12px; border-radius:14px;
    border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18);
  }
  .pbar{
    height:12px; border-radius:999px; background:#0d0f18; border:1px solid rgba(255,255,255,.10);
    overflow:hidden; margin-top:10px;
  }
  .pfill{
    height:100%; width:0%;
    background: linear-gradient(45deg, var(--lime), var(--cyan), var(--pink));
    transition: width .35s ease;
  }
  .checklist{display:grid; gap:10px; margin-top:10px; font-size:13px;}
  .item{
    padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18);
    display:flex; justify-content:space-between; gap:10px; align-items:center;
  }
  .tag{
    font-weight:900; padding:7px 10px; border-radius:999px;
    border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06);
    color:rgba(255,255,255,.90); white-space:nowrap;
  }
  .tag.ok{border-color: rgba(124,255,91,.30); background: rgba(124,255,91,.10)}
  .tag.wait{border-color: rgba(255,255,255,.18); background: rgba(255,255,255,.06)}

  /* ===== Blocks ===== */
  .blockGrid{display:grid; gap:10px; margin-top:10px;}
  .block{
    padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18);
  }
  .block b{display:block; margin-bottom:4px}
  .block span{color:rgba(255,255,255,.78); font-size:13px; line-height:1.5}

  .foot{text-align:center; font-size:12px; opacity:.55; margin: 12px 0 0; line-height:1.5;}

  /* ===== Modal PRO animation ===== */
  .modalOverlay{
    position:fixed; inset:0; background: rgba(0,0,0,.74);
    backdrop-filter: blur(10px);
    display:flex; justify-content:center; align-items:center;
    padding:14px; opacity:0; pointer-events:none;
    transition:.32s ease; z-index:999;
  }
  .modalOverlay.show{opacity:1; pointer-events:auto;}
  .modalBox{
    width:100%; max-width:520px;
    transform: scale(.86) translateY(40px);
    transition: .32s cubic-bezier(.2,.9,.2,1);
  }
  .modalOverlay.show .modalBox{transform: scale(1) translateY(0);}

  .modalHead{display:flex; justify-content:space-between; gap:12px; align-items:flex-start; margin-bottom:12px;}
  .xbtn{
    border:1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,.08);
    color: rgba(255,255,255,.90);
    border-radius:12px; padding:10px 12px;
    cursor:pointer; font-weight:900;
  }

  /* Steps grid */
  .grid{display:grid; grid-template-columns: 1fr 1fr; gap:12px;}
  @media (max-width:520px){ .grid{grid-template-columns:1fr} }

  .step{
    background: var(--card2);
    border: 1px solid rgba(255,255,255,.10);
    border-radius: 16px;
    padding: 14px;
    text-align:center;
    transition:.22s;
  }
  .step:hover{transform:translateY(-2px); box-shadow:0 12px 26px rgba(60,241,255,.10)}
  .step.locked{opacity:.55; filter:saturate(.8)}
  .step.done{border-color: rgba(124,255,91,.28); box-shadow: 0 0 22px rgba(124,255,91,.10)}

  .icon{
    width:48px; height:48px; border-radius:50%;
    margin: 0 auto 8px;
    display:flex; align-items:center; justify-content:center;
    background: linear-gradient(45deg, var(--lime), var(--cyan), var(--pink));
    color:#071022; font-size:20px; font-weight:900;
  }
  .step h4{margin:0 0 6px; font-size:14px}
  .step .desc{margin:0 0 10px; font-size:12px; color:rgba(255,255,255,.74); line-height:1.45}

  .sbtn{
    width:100%;
    padding:11px; border-radius:14px; border:0;
    cursor:pointer; font-weight:900;
    background: linear-gradient(45deg, var(--lime), var(--cyan), var(--pink));
    color:#071022; transition:.2s; margin-top:8px;
  }
  .sbtn:hover{transform:translateY(-1px)}
  .sbtn.secondary{
    background: rgba(255,255,255,.10);
    color: rgba(255,255,255,.92);
    border: 1px solid rgba(255,255,255,.16);
  }
  .sbtn:disabled{opacity:.55; cursor:not-allowed; transform:none}

  /* Inputs in step */
  .inp{
    width:100%;
    padding:11px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.16);
    background:rgba(0,0,0,.18);
    color:rgba(255,255,255,.92);
    outline:none;
    font-weight:900;
    margin-top:8px;
  }
  .hint{
    margin-top:8px;
    font-size:12px;
    color:rgba(255,255,255,.74);
    line-height:1.45;
  }

</style>
</head>

<body>
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="headerTop">
      <div class="brandLeft">
        <div class="moon" aria-hidden="true"></div>
        <div class="brandText">
          <h1 class="brandTitle">FastMoon</h1>
          <div class="brandSub">Official Project Page</div>
        </div>
      </div>

      <div class="miniCtas">
        <button class="miniBtn" onclick="go(CONFIG.twitterProfile)">Follow X</button>
        <button class="miniBtn" onclick="go(CONFIG.telegram)">Join TG</button>
      </div>
    </div>

    <div class="muted" style="font-size:13px; line-height:1.5">
      Verified links • No wallet connect • Always verify announcements publicly
    </div>
  </div>

  <!-- Join Airdrop -->
  <div class="card">
    <h3>Airdrop Participation</h3>
    <p class="muted" style="font-size:13px; line-height:1.55">
      Complete tasks to qualify. For verification, submit your Solana address + X username,
      then reply to the official tweet.
    </p>

    <div class="badgeRow">
      <div class="badge"> No wallet connect</div>
      <div class="badge"> Reply-based verification</div>
      <div class="badge"> One address per user</div>
    </div>

    <button class="btn" onclick="openAirdrop()">Join Airdrop </button>
    <button class="btn secondary" onclick="resetProgress()">Reset Progress</button>
  </div>

  <!-- Community Stats -->
  <div class="card">
    <h3>Community Stats</h3>
    <p class="muted" style="font-size:13px;line-height:1.55">
      Live stats will be updated during launch. (Placeholders shown below.)
    </p>

    <div class="stats">
      <div class="stat"><b>Holders</b><span id="statHolders">TBA</span></div>
      <div class="stat"><b>X Followers</b><span id="statX">TBA</span></div>
      <div class="stat"><b>Telegram Members</b><span id="statTg">TBA</span></div>
    </div>
  </div>

  <!-- Tokenomics -->
  <div class="card">
    <h3>Tokenomics</h3>

    <div class="token">
      <div class="tokRow"><span>LP</span><b>60%</b></div>
      <div class="bar"><div class="fill" style="width:60%"></div></div>
    </div>
    <div class="token">
      <div class="tokRow"><span>Presale</span><b>20%</b></div>
      <div class="bar"><div class="fill" style="width:20%"></div></div>
    </div>
    <div class="token">
      <div class="tokRow"><span>Airdrop</span><b>10%</b></div>
      <div class="bar"><div class="fill" style="width:10%"></div></div>
    </div>
    <div class="token">
      <div class="tokRow"><span>Marketing</span><b>10%</b></div>
      <div class="bar"><div class="fill" style="width:10%"></div></div>
    </div>
  </div>

  <!-- Official links + safety + copy tweet -->
  <div class="card">
    <h3>Official Links (Verified)</h3>
    <p class="muted" style="font-size:13px;line-height:1.55">
      Use only these links. We never DM contract addresses and never ask you to connect your wallet.
    </p>

    <div class="row2">
      <button class="btn" onclick="go(CONFIG.twitterProfile)">Twitter (X)</button>
      <button class="btn" onclick="go(CONFIG.telegram)">Telegram</button>
    </div>

    <div class="row2" style="margin-top:10px">
      <button class="btn secondary" onclick="go(CONFIG.pinnedTweet)">Open Pinned Tweet</button>
      <button class="btn secondary" onclick="copyText(CONFIG.officialAirdropTweet,'copyMsg2')">Copy Official Tweet Link</button>
    </div>
    <div id="copyMsg2" class="tiny"></div>

    <div style="margin-top:12px; padding:12px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18)">
      <b>Security Notice</b>
      <div class="muted" style="margin-top:6px;font-size:13px;line-height:1.55">
        • No wallet connect for airdrop participation<br>
        • Never trust DMs (CA/airdrops/“support”)<br>
        • Verify announcements only in public channels
      </div>
    </div>
  </div>

  <!-- Contract Address -->
  <div class="card">
    <h3>Contract Address</h3>
    <p class="muted" style="font-size:13px; line-height:1.55">
      The official contract address will be published on verified channels only.
      Always verify the announcement publicly.
    </p>

    <div class="caWrap">
      <div id="caBox" class="caBox">SOON</div>
      <button class="btn" style="flex:0 0 140px; margin-top:0" onclick="copyCA()">Copy CA</button>
    </div>
    <div id="copyMsg" class="tiny"></div>
  </div>

  <!-- Launch checklist -->
  <div class="card">
    <h3>Launch Checklist</h3>
    <p class="muted" style="font-size:13px;line-height:1.55">
      This checklist helps the community track launch milestones.
    </p>

    <div class="progressWrap">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:center">
        <b>Progress</b>
        <span class="muted" id="progressText">—</span>
      </div>
      <div class="pbar"><div class="pfill" id="pfill"></div></div>

      <div class="checklist" style="margin-top:12px">
        <div class="item"><span><b>Website</b><br><span class="muted">Live</span></span><span class="tag ok">DONE</span></div>
        <div class="item"><span><b>Airdrop Tasks</b><br><span class="muted">Live</span></span><span class="tag ok">DONE</span></div>
        <div class="item"><span><b>Contract Address</b><br><span class="muted">Pending</span></span><span class="tag wait">SOON</span></div>
        <div class="item"><span><b>Liquidity (LP)</b><br><span class="muted">Pending</span></span><span class="tag wait">SOON</span></div>
        <div class="item"><span><b>DEX Listing</b><br><span class="muted">Pending</span></span><span class="tag wait">SOON</span></div>
      </div>
    </div>
    <div class="tiny">Updates will be posted publicly on Twitter and Telegram.</div>
  </div>

  <!-- Roadmap -->
  <div class="card">
    <h3>Roadmap</h3>
    <div class="blockGrid">
      <div class="block"><b>Phase 1 — Community</b><span>Launch socials, airdrop participation, meme campaigns.</span></div>
      <div class="block"><b>Phase 2 — Launch</b><span>CA announcement, LP setup, listing, transparent updates.</span></div>
      <div class="block"><b>Phase 3 — Growth</b><span>Partnerships, community initiatives, future improvements driven by holders.</span></div>
    </div>
  </div>

  <!-- Project FAQ -->
  <div class="card">
    <h3>Project FAQ</h3>

    <div class="blockGrid">
      <div class="block">
        <b>What is FastMoon?</b>
        <span>FastMoon is a community-driven memecoin on Solana focused on social growth and transparent public updates.</span>
      </div>
      <div class="block">
        <b>How is “verification” handled?</b>
        <span>Verification is based on your submitted details and your public reply to the official tweet (proof). We do not require wallet connections.</span>
      </div>
      <div class="block">
        <b>Where is the official CA announced?</b>
        <span>Only on verified Twitter and Telegram. We never send CA via DMs.</span>
      </div>
      <div class="block">
        <b>Is there a claim page?</b>
        <span>No claim site is required. Distribution is processed after verification.</span>
      </div>
    </div>

    <div class="foot">Not financial advice. DYOR. FastMoon is not affiliated with X/Twitter or Telegram.</div>
  </div>

</div>

<!-- MODAL -->
<div id="airdropModal" class="modalOverlay" onclick="closeIfOutside(event)">
  <div class="modalBox">
    <div class="card" style="margin:0">
      <div class="modalHead">
        <div>
          <h3 style="margin:0 0 6px">Airdrop Tasks</h3>
          <p class="muted" style="font-size:13px; line-height:1.55; margin:0">
            Complete tasks in order. Final step: enter details and reply to the official tweet.
          </p>
        </div>
        <button class="xbtn" onclick="closeAirdrop()">Close</button>
      </div>

      <div class="grid">
        <!-- Step 1 -->
        <div class="step" id="step1">
          <div class="icon"></div>
          <h4>Follow on X</h4>
          <p class="desc">Follow our official account.</p>
          <button class="sbtn" onclick="go(CONFIG.twitterProfile); markDone(1)">Open Twitter </button>
          <button class="sbtn secondary" id="done1" onclick="markDone(1)">Mark as Done</button>
        </div>

        <!-- Step 2 -->
        <div class="step locked" id="step2">
          <div class="icon"></div>
          <h4>Repost Pinned Tweet</h4>
          <p class="desc">Repost the pinned announcement.</p>
          <button class="sbtn" id="open2" onclick="go(CONFIG.pinnedTweet); markDone(2)" disabled>Open Tweet </button>
          <button class="sbtn secondary" id="done2" onclick="markDone(2)" disabled>Mark as Done</button>
        </div>

        <!-- Step 3 -->
        <div class="step locked" id="step3">
          <div class="icon"></div>
          <h4>Join Telegram</h4>
          <p class="desc">Join the community channel.</p>
          <button class="sbtn" id="open3" onclick="go(CONFIG.telegram); markDone(3)" disabled>Join Telegram </button>
          <button class="sbtn secondary" id="done3" onclick="markDone(3)" disabled>Mark as Done</button>
        </div>

        <!-- Step 4 (NEW) -->
        <div class="step locked" id="step4">
          <div class="icon"></div>
          <h4>Submit & Verify</h4>
          <p class="desc">Enter your Solana address + X username, then reply to the official tweet.</p>

          <input class="inp" id="solAddr" placeholder="Solana Address (Base58)" disabled />
          <input class="inp" id="xUser" placeholder="X Username (e.g. @fastmoon)" disabled />
          <input class="inp" id="replyLink" placeholder="Reply Link (recommended)" disabled />

          <button class="sbtn" id="open4" onclick="go(CONFIG.officialAirdropTweet)" disabled>
            Open Official Tweet 
          </button>

          <button class="sbtn secondary" id="verify4" onclick="verifyAndDoneStep4()" disabled>
            Submit & Mark Verified
          </button>

          <div id="vMsg" class="hint">Complete Step 3 to unlock.</div>
        </div>
      </div>

      <div style="margin-top:12px; padding:12px; border-radius:16px; border:1px solid rgba(255,255,255,.12); background:rgba(0,0,0,.18)">
        <b>Status:</b> <span id="statusText" class="muted">Complete Step 1 to unlock Step 2.</span>
      </div>

    </div>
  </div>
</div>

<script>
/* =========================
   CONFIG — EDIT THESE LINKS
========================= */
const CONFIG = {
  twitterProfile: "https://twitter.com/YourProject",
  telegram: "https://t.me/YourProject",
  pinnedTweet: "https://twitter.com/YourProject/status/POSTID",
  officialAirdropTweet: "https://twitter.com/YourProject/status/TWEETID"
};

/* Helpers */
function go(url){ try { window.open(url, "_blank"); } catch(e) {} }

/* Copy any text */
function copyText(text, msgId){
  const msg = document.getElementById(msgId);
  if(!text || text.includes("POSTID") || text.includes("TWEETID") || text.includes("YourProject")){
    msg.textContent = "Update links in CONFIG first.";
    return;
  }
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(text).then(()=> msg.textContent="Copied ")
      .catch(()=> fallbackCopy(text, msg));
  }else fallbackCopy(text, msg);
}
function fallbackCopy(text, msgEl){
  const ta = document.createElement("textarea");
  ta.value = text;
  ta.style.position = "fixed";
  ta.style.opacity = "0";
  document.body.appendChild(ta);
  ta.focus(); ta.select();
  try{ document.execCommand("copy"); msgEl.textContent = "Copied "; }
  catch(e){ msgEl.textContent = "Copy failed — tap and hold to copy."; }
  document.body.removeChild(ta);
}

/* Modal open/close */
function openAirdrop(){ document.getElementById("airdropModal").classList.add("show"); }
function closeAirdrop(){ document.getElementById("airdropModal").classList.remove("show"); }
function closeIfOutside(e){ if(e.target && e.target.id === "airdropModal") closeAirdrop(); }

/* Validation */
function isValidSolana(a){
  if(!a) return false;
  a = a.trim();
  if(a.length < 32 || a.length > 44) return false;
  return /^[1-9A-HJ-NP-Za-km-z]+$/.test(a);
}
function isValidXUser(u){
  if(!u) return false;
  u = u.trim();
  if(u.startsWith("@")) u = u.slice(1);
  return /^[A-Za-z0-9_]{1,15}$/.test(u);
}
function normalizeXUser(u){
  u = (u || "").trim();
  if(!u) return "";
  return u.startsWith("@") ? u : ("@" + u);
}
function isValidReplyLink(url){
  if(!url) return true; // optional
  url = url.trim();
  // accept any https://x.com/... or https://twitter.com/...
  return /^https:\/\/(x\.com|twitter\.com)\/.+/i.test(url);
}

/* Step lock + Done checklist */
const STORE_KEY = "fastmoon_steps_v4";
const defaultState = { done: {1:false,2:false,3:false,4:false}, airdrop:{sol:"",x:"",reply:""} };

function loadState(){
  try{
    const raw = localStorage.getItem(STORE_KEY);
    if(!raw) return structuredClone(defaultState);
    const s = JSON.parse(raw);
    return {
      ...structuredClone(defaultState),
      ...s,
      done:{...defaultState.done, ...(s.done||{})},
      airdrop:{...defaultState.airdrop, ...(s.airdrop||{})}
    };
  }catch(_){ return structuredClone(defaultState); }
}
function saveState(){ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }
let state = loadState();

function resetProgress(){
  if(!confirm("Reset task progress + saved inputs?")) return;
  state = structuredClone(defaultState);
  saveState();
  renderSteps();
}

/* Step 1–3 done */
function markDone(step){
  if(step > 1 && !state.done[step-1]) return;
  state.done[step] = true;
  saveState();
  renderSteps();
}

/* Step 4 submit */
function verifyAndDoneStep4(){
  if(!state.done[3]) return;

  const addrEl = document.getElementById("solAddr");
  const userEl = document.getElementById("xUser");
  const repEl  = document.getElementById("replyLink");
  const msg = document.getElementById("vMsg");

  const addr = (addrEl.value || "").trim();
  const xraw = (userEl.value || "").trim();
  const xuser = normalizeXUser(xraw);
  const reply = (repEl.value || "").trim();

  if(!isValidSolana(addr)){
    msg.textContent = "Invalid Solana address format.";
    return;
  }
  if(!isValidXUser(xraw)){
    msg.textContent = "Invalid X username. Use @name (1–15 chars, letters/numbers/_).";
    return;
  }
  if(!isValidReplyLink(reply)){
    msg.textContent = "Reply link looks invalid. Use https://x.com/... or https://twitter.com/... (optional).";
    return;
  }

  state.airdrop = { sol: addr, x: xuser, reply: reply };
  state.done[4] = true;
  saveState();

  msg.textContent = "Saved  Now reply to the official tweet with your SOL address (public proof).";
  renderSteps();
}

function renderSteps(){
  // toggle step cards
  for(let i=1;i<=4;i++){
    const box = document.getElementById("step"+i);
    const isDone = !!state.done[i];
    const unlocked = (i===1) ? true : !!state.done[i-1];

    box.classList.toggle("done", isDone);
    box.classList.toggle("locked", !unlocked);

    const doneBtn = document.getElementById("done"+i);
    const openBtn = document.getElementById("open"+i);

    if(i===1){
      if(doneBtn){
        doneBtn.textContent = isDone ? "Done " : "Mark as Done";
        doneBtn.disabled = isDone;
      }
    } else if(i<=3){
      if(openBtn) openBtn.disabled = !unlocked;
      if(doneBtn){
        doneBtn.disabled = !unlocked || isDone;
        doneBtn.textContent = isDone ? "Done " : "Mark as Done";
      }
      if(openBtn){
        if(isDone) openBtn.textContent = "Completed ";
        else openBtn.textContent = (i===2) ? "Open Tweet " : "Join Telegram ";
      }
    }
  }

  // Step 4 inputs enable/disable + live validation
  const addrEl = document.getElementById("solAddr");
  const userEl = document.getElementById("xUser");
  const repEl  = document.getElementById("replyLink");
  const open4  = document.getElementById("open4");
  const verify4 = document.getElementById("verify4");
  const vMsg = document.getElementById("vMsg");

  if(addrEl && userEl && repEl && open4 && verify4 && vMsg){
    const unlocked4 = !!state.done[3];

    addrEl.disabled = !unlocked4;
    userEl.disabled = !unlocked4;
    repEl.disabled  = !unlocked4;
    open4.disabled  = !unlocked4;

    // preload saved
    if(state.airdrop?.sol && addrEl.value !== state.airdrop.sol) addrEl.value = state.airdrop.sol;
    if(state.airdrop?.x && userEl.value !== state.airdrop.x) userEl.value = state.airdrop.x;
    if(state.airdrop?.reply && repEl.value !== state.airdrop.reply) repEl.value = state.airdrop.reply;

    const okAddr = isValidSolana(addrEl.value);
    const okUser = isValidXUser(userEl.value);
    const okReply = isValidReplyLink(repEl.value);

    verify4.disabled = !(unlocked4 && okAddr && okUser && okReply && !state.done[4]);

    if(!unlocked4){
      vMsg.textContent = "Complete Step 3 to unlock.";
    } else if(state.done[4]){
      vMsg.textContent = "Submitted  Reply posted = verified by public proof.";
      open4.textContent = "Open Official Tweet ";
    } else {
      vMsg.textContent = "Fill address + username, then submit. Reply link is optional but recommended.";
      open4.textContent = "Open Official Tweet ";
    }
  }

  // status text
  const status = document.getElementById("statusText");
  if(state.done[4]) status.textContent = "All steps completed  You’re qualified (subject to verification).";
  else if(state.done[3]) status.textContent = "Step 4 unlocked: submit details and reply to the official tweet.";
  else if(state.done[2]) status.textContent = "Step 3 unlocked: join Telegram.";
  else if(state.done[1]) status.textContent = "Step 2 unlocked: repost the pinned tweet.";
  else status.textContent = "Complete Step 1 to unlock Step 2.";

  // persist typed inputs (when unlocked)
  if(state.done[3] && addrEl && userEl && repEl){
    state.airdrop.sol = (addrEl.value || "").trim();
    state.airdrop.x = normalizeXUser((userEl.value || "").trim());
    state.airdrop.reply = (repEl.value || "").trim();
    saveState();
  }
}
renderSteps();

document.addEventListener("input",(e)=>{
  if(!e.target) return;
  if(e.target.id==="solAddr" || e.target.id==="xUser" || e.target.id==="replyLink"){
    renderSteps();
  }
});

/* Copy CA */
function copyCA(){
  const el = document.getElementById("caBox");
  const msg = document.getElementById("copyMsg");
  const ca = (el.innerText || "").trim();

  if(!ca || ca.toUpperCase() === "SOON"){
    msg.textContent = "CA not announced yet.";
    return;
  }
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(ca).then(()=> msg.textContent = "Copied ")
      .catch(()=> fallbackCopy(ca, msg));
  } else fallbackCopy(ca, msg);
}

/* Checklist progress */
(function setChecklistProgress(){
  const doneCount = 2; // Website + Airdrop tasks
  const total = 5;
  const pct = Math.round((doneCount / total) * 100);
  document.getElementById("progressText").textContent = `${pct}% (${doneCount}/${total})`;
  document.getElementById("pfill").style.width = pct + "%";
})();
</script>

</body>
</html>